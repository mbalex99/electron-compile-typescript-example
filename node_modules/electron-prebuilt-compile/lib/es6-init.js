'use strict';

var _fs = require('fs');

var _fs2 = _interopRequireDefault(_fs);

var _path = require('path');

var _path2 = _interopRequireDefault(_path);

var _electronCompile = require('electron-compile');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function findPackageJson(initScript) {
  if (initScript === '/' || initScript.match(/^[A-Za-z]:$/)) {
    throw new Error("Can't find package.json");
  }

  // Walk up the parent directories until we find package.json. Make sure that
  // we're not actually stumbling upon a parent npm package
  var ret = _path2.default.join(initScript, 'package.json');
  if (_fs2.default.statSyncNoException(ret) && !_path2.default.resolve(_path2.default.dirname(ret), '..').match(/[\\\/]node_modules$/i)) {
    return ret;
  }

  return findPackageJson(_path2.default.dirname(initScript));
}

function main() {
  var initScript = _path2.default.resolve(process.argv[2]);
  var packageJson = findPackageJson(initScript);

  // Reconstitute the original arguments
  var args = process.argv.slice(2);
  process.argv = [process.argv[0]].concat(args);

  (0, _electronCompile.init)(_path2.default.dirname(packageJson), initScript);
}

main();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9lczYtaW5pdC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUlBLFNBQVMsZUFBZSxDQUFDLFVBQVUsRUFBRTtBQUNuQyxNQUFJLFVBQVUsS0FBSyxHQUFHLElBQUksVUFBVSxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsRUFBRTtBQUN6RCxVQUFNLElBQUksS0FBSyxDQUFDLHlCQUF5QixDQUFDLENBQUM7R0FDNUM7Ozs7QUFBQSxBQUlELE1BQUksR0FBRyxHQUFHLGVBQUssSUFBSSxDQUFDLFVBQVUsRUFBRSxjQUFjLENBQUMsQ0FBQTtBQUMvQyxNQUFJLGFBQUcsbUJBQW1CLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxlQUFLLE9BQU8sQ0FBQyxlQUFLLE9BQU8sQ0FBQyxHQUFHLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQyxLQUFLLENBQUMsc0JBQXNCLENBQUMsRUFBRTtBQUN2RyxXQUFPLEdBQUcsQ0FBQztHQUNaOztBQUVELFNBQU8sZUFBZSxDQUFDLGVBQUssT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7Q0FDbEQ7O0FBRUQsU0FBUyxJQUFJLEdBQUc7QUFDZCxNQUFJLFVBQVUsR0FBRyxlQUFLLE9BQU8sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDL0MsTUFBSSxXQUFXLEdBQUcsZUFBZSxDQUFDLFVBQVUsQ0FBQzs7O0FBQUMsQUFHOUMsTUFBSSxJQUFJLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDakMsU0FBTyxDQUFDLElBQUksR0FBRyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7O0FBRTlDLHVCQXpCTSxJQUFJLEVBeUJMLGVBQUssT0FBTyxDQUFDLFdBQVcsQ0FBQyxFQUFFLFVBQVUsQ0FBQyxDQUFBO0NBQzVDOztBQUVELElBQUksRUFBRSxDQUFBIiwiZmlsZSI6ImVzNi1pbml0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGZzIGZyb20gJ2ZzJztcclxuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XHJcbmltcG9ydCB7aW5pdH0gZnJvbSAnZWxlY3Ryb24tY29tcGlsZSc7XHJcblxyXG5mdW5jdGlvbiBmaW5kUGFja2FnZUpzb24oaW5pdFNjcmlwdCkge1xyXG4gIGlmIChpbml0U2NyaXB0ID09PSAnLycgfHwgaW5pdFNjcmlwdC5tYXRjaCgvXltBLVphLXpdOiQvKSkge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiQ2FuJ3QgZmluZCBwYWNrYWdlLmpzb25cIik7XHJcbiAgfVxyXG5cclxuICAvLyBXYWxrIHVwIHRoZSBwYXJlbnQgZGlyZWN0b3JpZXMgdW50aWwgd2UgZmluZCBwYWNrYWdlLmpzb24uIE1ha2Ugc3VyZSB0aGF0XHJcbiAgLy8gd2UncmUgbm90IGFjdHVhbGx5IHN0dW1ibGluZyB1cG9uIGEgcGFyZW50IG5wbSBwYWNrYWdlXHJcbiAgbGV0IHJldCA9IHBhdGguam9pbihpbml0U2NyaXB0LCAncGFja2FnZS5qc29uJylcclxuICBpZiAoZnMuc3RhdFN5bmNOb0V4Y2VwdGlvbihyZXQpICYmICFwYXRoLnJlc29sdmUocGF0aC5kaXJuYW1lKHJldCksICcuLicpLm1hdGNoKC9bXFxcXFxcL11ub2RlX21vZHVsZXMkL2kpKSB7XHJcbiAgICByZXR1cm4gcmV0O1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIGZpbmRQYWNrYWdlSnNvbihwYXRoLmRpcm5hbWUoaW5pdFNjcmlwdCkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBtYWluKCkge1xyXG4gIGxldCBpbml0U2NyaXB0ID0gcGF0aC5yZXNvbHZlKHByb2Nlc3MuYXJndlsyXSk7XHJcbiAgbGV0IHBhY2thZ2VKc29uID0gZmluZFBhY2thZ2VKc29uKGluaXRTY3JpcHQpO1xyXG5cclxuICAvLyBSZWNvbnN0aXR1dGUgdGhlIG9yaWdpbmFsIGFyZ3VtZW50c1xyXG4gIGxldCBhcmdzID0gcHJvY2Vzcy5hcmd2LnNsaWNlKDIpO1xyXG4gIHByb2Nlc3MuYXJndiA9IFtwcm9jZXNzLmFyZ3ZbMF1dLmNvbmNhdChhcmdzKTtcclxuICBcclxuICBpbml0KHBhdGguZGlybmFtZShwYWNrYWdlSnNvbiksIGluaXRTY3JpcHQpXHJcbn1cclxuXHJcbm1haW4oKVxyXG4iXX0=